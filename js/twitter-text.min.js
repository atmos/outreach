
if(typeof window==="undefined"||window===null){window={twttr:{}};}
if(window.twttr==null){window.twttr={};}
if(typeof twttr==="undefined"||twttr===null){twttr={};}
(function(){twttr.txt={};twttr.txt.regexen={};var HTML_ENTITIES={'&':'&amp;','>':'&gt;','<':'&lt;','"':'&quot;',"'":'&#39;'};twttr.txt.htmlEscape=function(text){return text&&text.replace(/[&"'><]/g,function(character){return HTML_ENTITIES[character];});};function regexSupplant(regex,flags){flags=flags||"";if(typeof regex!=="string"){if(regex.global&&flags.indexOf("g")<0){flags+="g";}
if(regex.ignoreCase&&flags.indexOf("i")<0){flags+="i";}
if(regex.multiline&&flags.indexOf("m")<0){flags+="m";}
regex=regex.source;}
return new RegExp(regex.replace(/#\{(\w+)\}/g,function(match,name){var newRegex=twttr.txt.regexen[name]||"";if(typeof newRegex!=="string"){newRegex=newRegex.source;}
return newRegex;}),flags);}
function stringSupplant(str,values){return str.replace(/#\{(\w+)\}/g,function(match,name){return values[name]||"";});}
function addCharsToCharClass(charClass,start,end){var s=String.fromCharCode(start);if(end!==start){s+="-"+String.fromCharCode(end);}
charClass.push(s);return charClass;}
var fromCode=String.fromCharCode;var UNICODE_SPACES=[fromCode(0x0020),fromCode(0x0085),fromCode(0x00A0),fromCode(0x1680),fromCode(0x180E),fromCode(0x2028),fromCode(0x2029),fromCode(0x202F),fromCode(0x205F),fromCode(0x3000)];addCharsToCharClass(UNICODE_SPACES,0x009,0x00D);addCharsToCharClass(UNICODE_SPACES,0x2000,0x200A);var INVALID_CHARS=[fromCode(0xFFFE),fromCode(0xFEFF),fromCode(0xFFFF)];addCharsToCharClass(INVALID_CHARS,0x202A,0x202E);twttr.txt.regexen.spaces_group=regexSupplant(UNICODE_SPACES.join(""));twttr.txt.regexen.spaces=regexSupplant("["+UNICODE_SPACES.join("")+"]");twttr.txt.regexen.invalid_chars_group=regexSupplant(INVALID_CHARS.join(""));twttr.txt.regexen.punct=/\!'#%&'\(\)*\+,\\\-\.\/:;<=>\?@\[\]\^_{|}~\$/;var nonLatinHashtagChars=[];addCharsToCharClass(nonLatinHashtagChars,0x0400,0x04ff);addCharsToCharClass(nonLatinHashtagChars,0x0500,0x0527);addCharsToCharClass(nonLatinHashtagChars,0x2de0,0x2dff);addCharsToCharClass(nonLatinHashtagChars,0xa640,0xa69f);addCharsToCharClass(nonLatinHashtagChars,0x0591,0x05bf);addCharsToCharClass(nonLatinHashtagChars,0x05c1,0x05c2);addCharsToCharClass(nonLatinHashtagChars,0x05c4,0x05c5);addCharsToCharClass(nonLatinHashtagChars,0x05c7,0x05c7);addCharsToCharClass(nonLatinHashtagChars,0x05d0,0x05ea);addCharsToCharClass(nonLatinHashtagChars,0x05f0,0x05f4);addCharsToCharClass(nonLatinHashtagChars,0xfb12,0xfb28);addCharsToCharClass(nonLatinHashtagChars,0xfb2a,0xfb36);addCharsToCharClass(nonLatinHashtagChars,0xfb38,0xfb3c);addCharsToCharClass(nonLatinHashtagChars,0xfb3e,0xfb3e);addCharsToCharClass(nonLatinHashtagChars,0xfb40,0xfb41);addCharsToCharClass(nonLatinHashtagChars,0xfb43,0xfb44);addCharsToCharClass(nonLatinHashtagChars,0xfb46,0xfb4f);addCharsToCharClass(nonLatinHashtagChars,0x0610,0x061a);addCharsToCharClass(nonLatinHashtagChars,0x0620,0x065f);addCharsToCharClass(nonLatinHashtagChars,0x066e,0x06d3);addCharsToCharClass(nonLatinHashtagChars,0x06d5,0x06dc);addCharsToCharClass(nonLatinHashtagChars,0x06de,0x06e8);addCharsToCharClass(nonLatinHashtagChars,0x06ea,0x06ef);addCharsToCharClass(nonLatinHashtagChars,0x06fa,0x06fc);addCharsToCharClass(nonLatinHashtagChars,0x06ff,0x06ff);addCharsToCharClass(nonLatinHashtagChars,0x0750,0x077f);addCharsToCharClass(nonLatinHashtagChars,0x08a0,0x08a0);addCharsToCharClass(nonLatinHashtagChars,0x08a2,0x08ac);addCharsToCharClass(nonLatinHashtagChars,0x08e4,0x08fe);addCharsToCharClass(nonLatinHashtagChars,0xfb50,0xfbb1);addCharsToCharClass(nonLatinHashtagChars,0xfbd3,0xfd3d);addCharsToCharClass(nonLatinHashtagChars,0xfd50,0xfd8f);addCharsToCharClass(nonLatinHashtagChars,0xfd92,0xfdc7);addCharsToCharClass(nonLatinHashtagChars,0xfdf0,0xfdfb);addCharsToCharClass(nonLatinHashtagChars,0xfe70,0xfe74);addCharsToCharClass(nonLatinHashtagChars,0xfe76,0xfefc);addCharsToCharClass(nonLatinHashtagChars,0x200c,0x200c);addCharsToCharClass(nonLatinHashtagChars,0x0e01,0x0e3a);addCharsToCharClass(nonLatinHashtagChars,0x0e40,0x0e4e);addCharsToCharClass(nonLatinHashtagChars,0x1100,0x11ff);addCharsToCharClass(nonLatinHashtagChars,0x3130,0x3185);addCharsToCharClass(nonLatinHashtagChars,0xA960,0xA97F);addCharsToCharClass(nonLatinHashtagChars,0xAC00,0xD7AF);addCharsToCharClass(nonLatinHashtagChars,0xD7B0,0xD7FF);addCharsToCharClass(nonLatinHashtagChars,0xFFA1,0xFFDC);addCharsToCharClass(nonLatinHashtagChars,0x30A1,0x30FA);addCharsToCharClass(nonLatinHashtagChars,0x30FC,0x30FE);addCharsToCharClass(nonLatinHashtagChars,0xFF66,0xFF9F);addCharsToCharClass(nonLatinHashtagChars,0xFF70,0xFF70);addCharsToCharClass(nonLatinHashtagChars,0xFF10,0xFF19);addCharsToCharClass(nonLatinHashtagChars,0xFF21,0xFF3A);addCharsToCharClass(nonLatinHashtagChars,0xFF41,0xFF5A);addCharsToCharClass(nonLatinHashtagChars,0x3041,0x3096);addCharsToCharClass(nonLatinHashtagChars,0x3099,0x309E);addCharsToCharClass(nonLatinHashtagChars,0x3400,0x4DBF);addCharsToCharClass(nonLatinHashtagChars,0x4E00,0x9FFF);addCharsToCharClass(nonLatinHashtagChars,0x2A700,0x2B73F);addCharsToCharClass(nonLatinHashtagChars,0x2B740,0x2B81F);addCharsToCharClass(nonLatinHashtagChars,0x2F800,0x2FA1F);addCharsToCharClass(nonLatinHashtagChars,0x3003,0x3003);addCharsToCharClass(nonLatinHashtagChars,0x3005,0x3005);addCharsToCharClass(nonLatinHashtagChars,0x303B,0x303B);twttr.txt.regexen.nonLatinHashtagChars=regexSupplant(nonLatinHashtagChars.join(""));var latinAccentChars=[];addCharsToCharClass(latinAccentChars,0x00c0,0x00d6);addCharsToCharClass(latinAccentChars,0x00d8,0x00f6);addCharsToCharClass(latinAccentChars,0x00f8,0x00ff);addCharsToCharClass(latinAccentChars,0x0100,0x024f);addCharsToCharClass(latinAccentChars,0x0253,0x0254);addCharsToCharClass(latinAccentChars,0x0256,0x0257);addCharsToCharClass(latinAccentChars,0x0259,0x0259);addCharsToCharClass(latinAccentChars,0x025b,0x025b);addCharsToCharClass(latinAccentChars,0x0263,0x0263);addCharsToCharClass(latinAccentChars,0x0268,0x0268);addCharsToCharClass(latinAccentChars,0x026f,0x026f);addCharsToCharClass(latinAccentChars,0x0272,0x0272);addCharsToCharClass(latinAccentChars,0x0289,0x0289);addCharsToCharClass(latinAccentChars,0x028b,0x028b);addCharsToCharClass(latinAccentChars,0x02bb,0x02bb);addCharsToCharClass(latinAccentChars,0x1e00,0x1eff);twttr.txt.regexen.latinAccentChars=regexSupplant(latinAccentChars.join(""));twttr.txt.regexen.hashSigns=/[#＃]/;twttr.txt.regexen.hashtagAlpha=regexSupplant(/[a-z_#{latinAccentChars}#{nonLatinHashtagChars}]/i);twttr.txt.regexen.hashtagAlphaNumeric=regexSupplant(/[a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}]/i);twttr.txt.regexen.endHashtagMatch=regexSupplant(/^(?:#{hashSigns}|:\/\/)/);twttr.txt.regexen.hashtagBoundary=regexSupplant(/(?:^|$|[^&a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}])/);twttr.txt.regexen.validHashtag=regexSupplant(/(#{hashtagBoundary})(#{hashSigns})(#{hashtagAlphaNumeric}*#{hashtagAlpha}#{hashtagAlphaNumeric}*)/gi);twttr.txt.regexen.validMentionPrecedingChars=/(?:^|[^a-zA-Z0-9_!#$%&*@＠]|RT:?)/;twttr.txt.regexen.atSigns=/[@＠]/;twttr.txt.regexen.validMentionOrList=regexSupplant('(#{validMentionPrecedingChars})'+'(#{atSigns})'+'([a-zA-Z0-9_]{1,20})'+'(\/[a-zA-Z][a-zA-Z0-9_\-]{0,24})?','g');twttr.txt.regexen.validReply=regexSupplant(/^(?:#{spaces})*#{atSigns}([a-zA-Z0-9_]{1,20})/);twttr.txt.regexen.endMentionMatch=regexSupplant(/^(?:#{atSigns}|[#{latinAccentChars}]|:\/\/)/);twttr.txt.regexen.validUrlPrecedingChars=regexSupplant(/(?:[^A-Za-z0-9@＠$#＃#{invalid_chars_group}]|^)/);twttr.txt.regexen.invalidUrlWithoutProtocolPrecedingChars=/[-_.\/]$/;twttr.txt.regexen.invalidDomainChars=stringSupplant("#{punct}#{spaces_group}#{invalid_chars_group}",twttr.txt.regexen);twttr.txt.regexen.validDomainChars=regexSupplant(/[^#{invalidDomainChars}]/);twttr.txt.regexen.validSubdomain=regexSupplant(/(?:(?:#{validDomainChars}(?:[_-]|#{validDomainChars})*)?#{validDomainChars}\.)/);twttr.txt.regexen.validDomainName=regexSupplant(/(?:(?:#{validDomainChars}(?:-|#{validDomainChars})*)?#{validDomainChars}\.)/);twttr.txt.regexen.validGTLD=regexSupplant(/(?:(?:aero|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|pro|tel|travel|xxx)(?=[^0-9a-zA-Z]|$))/);twttr.txt.regexen.validCCTLD=regexSupplant(/(?:(?:ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)(?=[^0-9a-zA-Z]|$))/);twttr.txt.regexen.validPunycode=regexSupplant(/(?:xn--[0-9a-z]+)/);twttr.txt.regexen.validDomain=regexSupplant(/(?:#{validSubdomain}*#{validDomainName}(?:#{validGTLD}|#{validCCTLD}|#{validPunycode}))/);twttr.txt.regexen.validAsciiDomain=regexSupplant(/(?:(?:[a-z0-9#{latinAccentChars}]+)\.)+(?:#{validGTLD}|#{validCCTLD}|#{validPunycode})/gi);twttr.txt.regexen.invalidShortDomain=regexSupplant(/^#{validDomainName}#{validCCTLD}$/);twttr.txt.regexen.validPortNumber=regexSupplant(/[0-9]+/);twttr.txt.regexen.validGeneralUrlPathChars=regexSupplant(/[a-z0-9!\*';:=\+,\.\$\/%#\[\]\-_~|&#{latinAccentChars}]/i);twttr.txt.regexen.validUrlBalancedParens=regexSupplant(/\(#{validGeneralUrlPathChars}+\)/i);twttr.txt.regexen.validUrlPathEndingChars=regexSupplant(/[\+\-a-z0-9=_#\/#{latinAccentChars}]|(?:#{validUrlBalancedParens})/i);twttr.txt.regexen.validUrlPath=regexSupplant('(?:'+'(?:'+'#{validGeneralUrlPathChars}*'+'(?:#{validUrlBalancedParens}#{validGeneralUrlPathChars}*)*'+'#{validUrlPathEndingChars}'+')|(?:@#{validGeneralUrlPathChars}+\/)'+')','i');twttr.txt.regexen.validUrlQueryChars=/[a-z0-9!?\*'\(\);:&=\+\$\/%#\[\]\-_\.,~|]/i;twttr.txt.regexen.validUrlQueryEndingChars=/[a-z0-9_&=#\/]/i;twttr.txt.regexen.extractUrl=regexSupplant('('+'(#{validUrlPrecedingChars})'+'('+'(https?:\\/\\/)?'+'(#{validDomain})'+'(?::(#{validPortNumber}))?'+'(\\/#{validUrlPath}*)?'+'(\\?#{validUrlQueryChars}*#{validUrlQueryEndingChars})?'+')'+')','gi');twttr.txt.regexen.validTcoUrl=/^https?:\/\/t\.co\/[a-z0-9]+/i;twttr.txt.regexen.validateUrlUnreserved=/[a-z0-9\-._~]/i;twttr.txt.regexen.validateUrlPctEncoded=/(?:%[0-9a-f]{2})/i;twttr.txt.regexen.validateUrlSubDelims=/[!$&'()*+,;=]/i;twttr.txt.regexen.validateUrlPchar=regexSupplant('(?:'+'#{validateUrlUnreserved}|'+'#{validateUrlPctEncoded}|'+'#{validateUrlSubDelims}|'+'[:|@]'+')','i');twttr.txt.regexen.validateUrlScheme=/(?:[a-z][a-z0-9+\-.]*)/i;twttr.txt.regexen.validateUrlUserinfo=regexSupplant('(?:'+'#{validateUrlUnreserved}|'+'#{validateUrlPctEncoded}|'+'#{validateUrlSubDelims}|'+':'+')*','i');twttr.txt.regexen.validateUrlDecOctet=/(?:[0-9]|(?:[1-9][0-9])|(?:1[0-9]{2})|(?:2[0-4][0-9])|(?:25[0-5]))/i;twttr.txt.regexen.validateUrlIpv4=regexSupplant(/(?:#{validateUrlDecOctet}(?:\.#{validateUrlDecOctet}){3})/i);twttr.txt.regexen.validateUrlIpv6=/(?:\[[a-f0-9:\.]+\])/i;twttr.txt.regexen.validateUrlIp=regexSupplant('(?:'+'#{validateUrlIpv4}|'+'#{validateUrlIpv6}'+')','i');twttr.txt.regexen.validateUrlSubDomainSegment=/(?:[a-z0-9](?:[a-z0-9_\-]*[a-z0-9])?)/i;twttr.txt.regexen.validateUrlDomainSegment=/(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?)/i;twttr.txt.regexen.validateUrlDomainTld=/(?:[a-z](?:[a-z0-9\-]*[a-z0-9])?)/i;twttr.txt.regexen.validateUrlDomain=regexSupplant(/(?:(?:#{validateUrlSubDomainSegment]}\.)*(?:#{validateUrlDomainSegment]}\.)#{validateUrlDomainTld})/i);twttr.txt.regexen.validateUrlHost=regexSupplant('(?:'+'#{validateUrlIp}|'+'#{validateUrlDomain}'+')','i');twttr.txt.regexen.validateUrlUnicodeSubDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9_\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i;twttr.txt.regexen.validateUrlUnicodeDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i;twttr.txt.regexen.validateUrlUnicodeDomainTld=/(?:(?:[a-z]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i;twttr.txt.regexen.validateUrlUnicodeDomain=regexSupplant(/(?:(?:#{validateUrlUnicodeSubDomainSegment}\.)*(?:#{validateUrlUnicodeDomainSegment}\.)#{validateUrlUnicodeDomainTld})/i);twttr.txt.regexen.validateUrlUnicodeHost=regexSupplant('(?:'+'#{validateUrlIp}|'+'#{validateUrlUnicodeDomain}'+')','i');twttr.txt.regexen.validateUrlPort=/[0-9]{1,5}/;twttr.txt.regexen.validateUrlUnicodeAuthority=regexSupplant('(?:(#{validateUrlUserinfo})@)?'+'(#{validateUrlUnicodeHost})'+'(?::(#{validateUrlPort}))?',"i");twttr.txt.regexen.validateUrlAuthority=regexSupplant('(?:(#{validateUrlUserinfo})@)?'+'(#{validateUrlHost})'+'(?::(#{validateUrlPort}))?',"i");twttr.txt.regexen.validateUrlPath=regexSupplant(/(\/#{validateUrlPchar}*)*/i);twttr.txt.regexen.validateUrlQuery=regexSupplant(/(#{validateUrlPchar}|\/|\?)*/i);twttr.txt.regexen.validateUrlFragment=regexSupplant(/(#{validateUrlPchar}|\/|\?)*/i);twttr.txt.regexen.validateUrlUnencoded=regexSupplant('^'+'(?:'+'([^:/?#]+):\\/\\/'+')?'+'([^/?#]*)'+'([^?#]*)'+'(?:'+'\\?([^#]*)'+')?'+'(?:'+'#(.*)'+')?$',"i");var DEFAULT_URL_CLASS="tweet-url";var DEFAULT_LIST_CLASS="list-slug";var DEFAULT_USERNAME_CLASS="username";var DEFAULT_HASHTAG_CLASS="hashtag";var HTML_ATTR_NO_FOLLOW=" rel=\"nofollow\"";var OPTIONS_NOT_ATTRIBUTES={'urlClass':true,'listClass':true,'usernameClass':true,'hashtagClass':true,'usernameUrlBase':true,'listUrlBase':true,'hashtagUrlBase':true,'usernameUrlBlock':true,'listUrlBlock':true,'hashtagUrlBlock':true,'linkUrlBlock':true,'usernameIncludeSymbol':true,'suppressLists':true,'suppressNoFollow':true,'suppressDataScreenName':true,'urlEntities':true,'before':true};var BOOLEAN_ATTRIBUTES={'disabled':true,'readonly':true,'multiple':true,'checked':true};function clone(o){var r={};for(var k in o){if(o.hasOwnProperty(k)){r[k]=o[k];}}
return r;}
twttr.txt.linkToHashtag=function(entity,text,options){var d={hash:text.substring(entity.indices[0],entity.indices[0]+1),preText:"",text:twttr.txt.htmlEscape(entity.hashtag),postText:"",extraHtml:options.suppressNoFollow?"":HTML_ATTR_NO_FOLLOW};for(var k in options){if(options.hasOwnProperty(k)){d[k]=options[k];}}
return stringSupplant("#{before}<a href=\"#{hashtagUrlBase}#{text}\" title=\"##{text}\" class=\"#{urlClass} #{hashtagClass}\"#{extraHtml}>#{hash}#{preText}#{text}#{postText}</a>",d);};twttr.txt.linkToMentionAndList=function(entity,text,options){var at=text.substring(entity.indices[0],entity.indices[0]+1);var d={at:options.usernameIncludeSymbol?"":at,at_before_user:options.usernameIncludeSymbol?at:"",user:twttr.txt.htmlEscape(entity.screenName),slashListname:twttr.txt.htmlEscape(entity.listSlug),extraHtml:options.suppressNoFollow?"":HTML_ATTR_NO_FOLLOW,preChunk:"",postChunk:""};for(var k in options){if(options.hasOwnProperty(k)){d[k]=options[k];}}
if(entity.listSlug&&!options.suppressLists){var list=d.chunk=stringSupplant("#{user}#{slashListname}",d);d.list=twttr.txt.htmlEscape(list.toLowerCase());return stringSupplant("#{before}#{at}<a class=\"#{urlClass} #{listClass}\" href=\"#{listUrlBase}#{list}\"#{extraHtml}>#{preChunk}#{at_before_user}#{chunk}#{postChunk}</a>",d);}else{d.chunk=d.user;d.dataScreenName=!options.suppressDataScreenName?stringSupplant("data-screen-name=\"#{chunk}\" ",d):"";return stringSupplant("#{before}#{at}<a class=\"#{urlClass} #{usernameClass}\" #{dataScreenName}href=\"#{usernameUrlBase}#{chunk}\"#{extraHtml}>#{preChunk}#{at_before_user}#{chunk}#{postChunk}</a>",d);}};twttr.txt.linkToUrl=function(entity,text,options){var url=entity.url;var displayUrl=url;var linkText=twttr.txt.htmlEscape(displayUrl);if(options.urlEntities&&options.urlEntities[url]&&options.urlEntities[url].display_url){var displayUrl=options.urlEntities[url].display_url;var expandedUrl=options.urlEntities[url].expanded_url;if(!options.title){options.title=expandedUrl;}
var displayUrlSansEllipses=displayUrl.replace(/…/g,"");if(expandedUrl.indexOf(displayUrlSansEllipses)!=-1){var displayUrlIndex=expandedUrl.indexOf(displayUrlSansEllipses);var v={displayUrlSansEllipses:displayUrlSansEllipses,beforeDisplayUrl:expandedUrl.substr(0,displayUrlIndex),afterDisplayUrl:expandedUrl.substr(displayUrlIndex+displayUrlSansEllipses.length),precedingEllipsis:displayUrl.match(/^…/)?"…":"",followingEllipsis:displayUrl.match(/…$/)?"…":""};$.each(v,function(index,value){v[index]=twttr.txt.htmlEscape(value);});v['invisible']="style='font-size:0; line-height:0'";linkText=stringSupplant("<span class='tco-ellipsis'>#{precedingEllipsis}<span #{invisible}>&nbsp;</span></span><span #{invisible}>#{beforeDisplayUrl}</span><span class='js-display-url'>#{displayUrlSansEllipses}</span><span #{invisible}>#{afterDisplayUrl}</span><span class='tco-ellipsis'><span #{invisible}>&nbsp;</span>#{followingEllipsis}</span>",v);}}
var d={htmlAttrs:options.htmlAttrs,url:twttr.txt.htmlEscape(url),linkText:linkText};return stringSupplant("<a href=\"#{url}\"#{htmlAttrs}>#{linkText}</a>",d);};twttr.txt.autoLinkEntities=function(text,entities,options){options=clone(options||{});if(!options.suppressNoFollow){options.rel="nofollow";}
if(options.urlClass){options["class"]=options.urlClass;}
options.urlClass=options.urlClass||DEFAULT_URL_CLASS;options.hashtagClass=options.hashtagClass||DEFAULT_HASHTAG_CLASS;options.hashtagUrlBase=options.hashtagUrlBase||"https://twitter.com/#!/search?q=%23";options.listClass=options.listClass||DEFAULT_LIST_CLASS;options.usernameClass=options.usernameClass||DEFAULT_USERNAME_CLASS;options.usernameUrlBase=options.usernameUrlBase||"https://twitter.com/";options.listUrlBase=options.listUrlBase||"https://twitter.com/";options.before=options.before||"";options.htmlAttrs=twttr.txt.extractHtmlAttrsFromOptions(options);var urlEntities,i,len;if(options.urlEntities){urlEntities={};for(i=0,len=options.urlEntities.length;i<len;i++){urlEntities[options.urlEntities[i].url]=options.urlEntities[i];}
options.urlEntities=urlEntities;}
var result="";var beginIndex=0;for(var i=0;i<entities.length;i++){var entity=entities[i];result+=text.substring(beginIndex,entity.indices[0]);if(entity.url){result+=twttr.txt.linkToUrl(entity,text,options);}else if(entity.hashtag){result+=twttr.txt.linkToHashtag(entity,text,options);}else if(entity.screenName){result+=twttr.txt.linkToMentionAndList(entity,text,options);}
beginIndex=entity.indices[1];}
result+=text.substring(beginIndex,text.length);return result;};twttr.txt.extractHtmlAttrsFromOptions=function(options){var htmlAttrs="";for(var k in options){var v=options[k];if(OPTIONS_NOT_ATTRIBUTES[k])continue;if(BOOLEAN_ATTRIBUTES[k]){v=v?k:null;}
if(v==null)continue;htmlAttrs+=stringSupplant(" #{k}=\"#{v}\" ",{k:twttr.txt.htmlEscape(k),v:twttr.txt.htmlEscape(v.toString())});}
return htmlAttrs;};twttr.txt.autoLink=function(text,options){var entities=twttr.txt.extractEntitiesWithIndices(text,{extractUrlWithoutProtocol:false});return twttr.txt.autoLinkEntities(text,entities,options);};twttr.txt.autoLinkUsernamesOrLists=function(text,options){var entities=twttr.txt.extractMentionsOrListsWithIndices(text);return twttr.txt.autoLinkEntities(text,entities,options);};twttr.txt.autoLinkHashtags=function(text,options){var entities=twttr.txt.extractHashtagsWithIndices(text);return twttr.txt.autoLinkEntities(text,entities,options);};twttr.txt.autoLinkUrlsCustom=function(text,options){var entities=twttr.txt.extractUrlsWithIndices(text,{extractUrlWithoutProtocol:false});return twttr.txt.autoLinkEntities(text,entities,options);};twttr.txt.removeOverlappingEntities=function(entities){entities.sort(function(a,b){return a.indices[0]-b.indices[0];});var prev=entities[0];for(var i=1;i<entities.length;i++){if(prev.indices[1]>entities[i].indices[0]){entities.splice(i,1);i--;}else{prev=entities[i];}}};twttr.txt.extractEntitiesWithIndices=function(text,options){var entities=twttr.txt.extractUrlsWithIndices(text,options).concat(twttr.txt.extractMentionsOrListsWithIndices(text)).concat(twttr.txt.extractHashtagsWithIndices(text,{checkUrlOverlap:false}));if(entities.length==0){return[];}
twttr.txt.removeOverlappingEntities(entities);return entities;};twttr.txt.extractMentions=function(text){var screenNamesOnly=[],screenNamesWithIndices=twttr.txt.extractMentionsWithIndices(text);for(var i=0;i<screenNamesWithIndices.length;i++){var screenName=screenNamesWithIndices[i].screenName;screenNamesOnly.push(screenName);}
return screenNamesOnly;};twttr.txt.extractMentionsWithIndices=function(text){var mentions=[];var mentionsOrLists=twttr.txt.extractMentionsOrListsWithIndices(text);for(var i=0;i<mentionsOrLists.length;i++){mentionOrList=mentionsOrLists[i];if(mentionOrList.listSlug==''){mentions.push({screenName:mentionOrList.screenName,indices:mentionOrList.indices});}}
return mentions;};twttr.txt.extractMentionsOrListsWithIndices=function(text){if(!text||!text.match(twttr.txt.regexen.atSign)){return[];}
var possibleNames=[],position=0;text.replace(twttr.txt.regexen.validMentionOrList,function(match,before,atSign,screenName,slashListname,offset,chunk){var after=chunk.slice(offset+match.length);if(!after.match(twttr.txt.regexen.endMentionMatch)){slashListname=slashListname||'';var startPosition=text.indexOf(atSign+screenName+slashListname,position);position=startPosition+screenName.length+slashListname.length+1;possibleNames.push({screenName:screenName,listSlug:slashListname,indices:[startPosition,position]});}});return possibleNames;};twttr.txt.extractReplies=function(text){if(!text){return null;}
var possibleScreenName=text.match(twttr.txt.regexen.validReply);if(!possibleScreenName||RegExp.rightContext.match(twttr.txt.regexen.endMentionMatch)){return null;}
return possibleScreenName[1];};twttr.txt.extractUrls=function(text,options){var urlsOnly=[],urlsWithIndices=twttr.txt.extractUrlsWithIndices(text,options);for(var i=0;i<urlsWithIndices.length;i++){urlsOnly.push(urlsWithIndices[i].url);}
return urlsOnly;};twttr.txt.extractUrlsWithIndices=function(text,options){if(!options){options={extractUrlsWithoutProtocol:true};}
if(!text||(options.extractUrlsWithoutProtocol?!text.match(/\./):!text.match(/:/))){return[];}
var urls=[];while(twttr.txt.regexen.extractUrl.exec(text)){var before=RegExp.$2,url=RegExp.$3,protocol=RegExp.$4,domain=RegExp.$5,path=RegExp.$7;var endPosition=twttr.txt.regexen.extractUrl.lastIndex,startPosition=endPosition-url.length;if(!protocol){if(!options.extractUrlsWithoutProtocol||before.match(twttr.txt.regexen.invalidUrlWithoutProtocolPrecedingChars)){continue;}
var lastUrl=null,lastUrlInvalidMatch=false,asciiEndPosition=0;domain.replace(twttr.txt.regexen.validAsciiDomain,function(asciiDomain){var asciiStartPosition=domain.indexOf(asciiDomain,asciiEndPosition);asciiEndPosition=asciiStartPosition+asciiDomain.length;lastUrl={url:asciiDomain,indices:[startPosition+asciiStartPosition,startPosition+asciiEndPosition]};lastUrlInvalidMatch=asciiDomain.match(twttr.txt.regexen.invalidShortDomain);if(!lastUrlInvalidMatch){urls.push(lastUrl);}});if(lastUrl==null){continue;}
if(path){if(lastUrlInvalidMatch){urls.push(lastUrl);}
lastUrl.url=url.replace(domain,lastUrl.url);lastUrl.indices[1]=endPosition;}}else{if(url.match(twttr.txt.regexen.validTcoUrl)){url=RegExp.lastMatch;endPosition=startPosition+url.length;}
urls.push({url:url,indices:[startPosition,endPosition]});}}
return urls;};twttr.txt.extractHashtags=function(text){var hashtagsOnly=[],hashtagsWithIndices=twttr.txt.extractHashtagsWithIndices(text);for(var i=0;i<hashtagsWithIndices.length;i++){hashtagsOnly.push(hashtagsWithIndices[i].hashtag);}
return hashtagsOnly;};twttr.txt.extractHashtagsWithIndices=function(text,options){if(!options){options={checkUrlOverlap:true};}
if(!text||!text.match(twttr.txt.regexen.hashSigns)){return[];}
var tags=[],position=0;text.replace(twttr.txt.regexen.validHashtag,function(match,before,hash,hashText,offset,chunk){var after=chunk.slice(offset+match.length);if(after.match(twttr.txt.regexen.endHashtagMatch))
return;var startPosition=text.indexOf(hash+hashText,position);position=startPosition+hashText.length+1;tags.push({hashtag:hashText,indices:[startPosition,position]});});if(options.checkUrlOverlap){var urls=twttr.txt.extractUrlsWithIndices(text);if(urls.length>0){var entities=tags.concat(urls);twttr.txt.removeOverlappingEntities(entities);tags=[];for(var i=0;i<entities.length;i++){if(entities[i].hashtag){tags.push(entities[i]);}}}}
return tags;};twttr.txt.modifyIndicesFromUnicodeToUTF16=function(text,entities){twttr.txt.convertUnicodeIndices(text,entities,false);};twttr.txt.modifyIndicesFromUTF16ToUnicode=function(text,entities){twttr.txt.convertUnicodeIndices(text,entities,true);};twttr.txt.convertUnicodeIndices=function(text,entities,indicesInUTF16){if(entities.length==0){return;}
var charIndex=0;var codePointIndex=0;entities.sort(function(a,b){return a.indices[0]-b.indices[0];});var entityIndex=0;var entity=entities[0];while(charIndex<text.length){if(entity.indices[0]==(indicesInUTF16?charIndex:codePointIndex)){var len=entity.indices[1]-entity.indices[0];entity.indices[0]=indicesInUTF16?codePointIndex:charIndex;entity.indices[1]=entity.indices[0]+len;entityIndex++;if(entityIndex==entities.length){break;}
entity=entities[entityIndex];}
var c=text.charCodeAt(charIndex);if(0xD800<=c&&c<=0xDBFF&&charIndex<text.length-1){c=text.charCodeAt(charIndex+1);if(0xDC00<=c&&c<=0xDFFF){charIndex++;}}
codePointIndex++;charIndex++;}};twttr.txt.splitTags=function(text){var firstSplits=text.split("<"),secondSplits,allSplits=[],split;for(var i=0;i<firstSplits.length;i+=1){split=firstSplits[i];if(!split){allSplits.push("");}else{secondSplits=split.split(">");for(var j=0;j<secondSplits.length;j+=1){allSplits.push(secondSplits[j]);}}}
return allSplits;};twttr.txt.hitHighlight=function(text,hits,options){var defaultHighlightTag="em";hits=hits||[];options=options||{};if(hits.length===0){return text;}
var tagName=options.tag||defaultHighlightTag,tags=["<"+tagName+">","</"+tagName+">"],chunks=twttr.txt.splitTags(text),i,j,result="",chunkIndex=0,chunk=chunks[0],prevChunksLen=0,chunkCursor=0,startInChunk=false,chunkChars=chunk,flatHits=[],index,hit,tag,placed,hitSpot;for(i=0;i<hits.length;i+=1){for(j=0;j<hits[i].length;j+=1){flatHits.push(hits[i][j]);}}
for(index=0;index<flatHits.length;index+=1){hit=flatHits[index];tag=tags[index%2];placed=false;while(chunk!=null&&hit>=prevChunksLen+chunk.length){result+=chunkChars.slice(chunkCursor);if(startInChunk&&hit===prevChunksLen+chunkChars.length){result+=tag;placed=true;}
if(chunks[chunkIndex+1]){result+="<"+chunks[chunkIndex+1]+">";}
prevChunksLen+=chunkChars.length;chunkCursor=0;chunkIndex+=2;chunk=chunks[chunkIndex];chunkChars=chunk;startInChunk=false;}
if(!placed&&chunk!=null){hitSpot=hit-prevChunksLen;result+=chunkChars.slice(chunkCursor,hitSpot)+tag;chunkCursor=hitSpot;if(index%2===0){startInChunk=true;}else{startInChunk=false;}}else if(!placed){placed=true;result+=tag;}}
if(chunk!=null){if(chunkCursor<chunkChars.length){result+=chunkChars.slice(chunkCursor);}
for(index=chunkIndex+1;index<chunks.length;index+=1){result+=(index%2===0?chunks[index]:"<"+chunks[index]+">");}}
return result;};var MAX_LENGTH=140;var INVALID_CHARACTERS=[fromCode(0xFFFE),fromCode(0xFEFF),fromCode(0xFFFF),fromCode(0x202A),fromCode(0x202B),fromCode(0x202C),fromCode(0x202D),fromCode(0x202E)];twttr.txt.isInvalidTweet=function(text){if(!text){return"empty";}
if(text.length>MAX_LENGTH){return"too_long";}
for(var i=0;i<INVALID_CHARACTERS.length;i++){if(text.indexOf(INVALID_CHARACTERS[i])>=0){return"invalid_characters";}}
return false;};twttr.txt.isValidTweetText=function(text){return!twttr.txt.isInvalidTweet(text);};twttr.txt.isValidUsername=function(username){if(!username){return false;}
var extracted=twttr.txt.extractMentions(username);return extracted.length===1&&extracted[0]===username.slice(1);};var VALID_LIST_RE=regexSupplant(/^#{validMentionOrList}$/);twttr.txt.isValidList=function(usernameList){var match=usernameList.match(VALID_LIST_RE);return!!(match&&match[1]==""&&match[4]);};twttr.txt.isValidHashtag=function(hashtag){if(!hashtag){return false;}
var extracted=twttr.txt.extractHashtags(hashtag);return extracted.length===1&&extracted[0]===hashtag.slice(1);};twttr.txt.isValidUrl=function(url,unicodeDomains,requireProtocol){if(unicodeDomains==null){unicodeDomains=true;}
if(requireProtocol==null){requireProtocol=true;}
if(!url){return false;}
var urlParts=url.match(twttr.txt.regexen.validateUrlUnencoded);if(!urlParts||urlParts[0]!==url){return false;}
var scheme=urlParts[1],authority=urlParts[2],path=urlParts[3],query=urlParts[4],fragment=urlParts[5];if(!((!requireProtocol||(isValidMatch(scheme,twttr.txt.regexen.validateUrlScheme)&&scheme.match(/^https?$/i)))&&isValidMatch(path,twttr.txt.regexen.validateUrlPath)&&isValidMatch(query,twttr.txt.regexen.validateUrlQuery,true)&&isValidMatch(fragment,twttr.txt.regexen.validateUrlFragment,true))){return false;}
return(unicodeDomains&&isValidMatch(authority,twttr.txt.regexen.validateUrlUnicodeAuthority))||(!unicodeDomains&&isValidMatch(authority,twttr.txt.regexen.validateUrlAuthority));};function isValidMatch(string,regex,optional){if(!optional){return((typeof string==="string")&&string.match(regex)&&RegExp["$&"]===string);}
return(!string||(string.match(regex)&&RegExp["$&"]===string));}
if(typeof module!='undefined'&&module.exports){module.exports=twttr.txt;}}());